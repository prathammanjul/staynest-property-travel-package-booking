<% layout("layouts/boilerplate") %>
 <link href="/css/showPackage.css" rel="stylesheet" />




<div>
  <section class="poster">
    <div
    class="head"
    style="background-image: url('<%= package.image.url %>')"
  >
      
      <div class="back-btn btn" >
        <button class="button btn-signup" id="backBtn">Back</button>
      </div>
      <div class="content">
        <div class="rating">
          <p class="best-seller premium category"><%=package.category %></p>
        </div>
        <h1><%=package.title %></h1>
        <div class="mid">
          <p class="location">
            <i class="fas fa-map-marker-alt"></i> <%=package.country %>
          </p>
        </div>

        <div class="bottom">
          <p class="discount-price">
            &#8377; <%= package.price ? package.price.toLocaleString("en-IN") :
            "0" %>
          </p>
        </div>
        <p class="person">per person</p>
      </div>

       <div class="center">
        

        <% if (currUser && currUser._id.equals(package.owner._id)) { %>
          <div class="btn">
            <a href="/packages/<%= package.id%>/edit" class="btn-signup book">
              Edit →
            </a>
          </div>
          <form method="post" action="/packages/<%= package.id %>?_method=Delete">
            <button class="btn-signup book">Delete this listing</button>
          </form> 
      </div>
      </div>
      <% } %>

      

      </div>
    </div>
  </section>


  
  <!-- Main Content with Sidebar Layout -->
  <div class="main-content">
    <!-- Left Side Content -->
    <section class="left-side">
      <div class="section">
        <div class="bullet-details">
          <div class="icon"><i class="fa-regular fa-clock"></i></div>
          <div class="days"><%=package.duration %> Days </div>
          <div class="duration">Duration</div>
        </div>

        <div class="bullet-details">
          <div class="icon"><i class="fa-solid fa-users"></i></div>
          <div class="days"><%=package.groupSize %> people</div>
          <div class="duration">Group Size</div>
        </div>

        <div class="bullet-details">
          <div class="icon"><i class="fa-solid fa-star"></i></div>
          <div class="days"><%= "4/5"%></div>
          <div class="duration">Rating</div>
        </div>

        <div class="bullet-details">
          <div class="icon"><i class="fa-solid fa-heart"></i></div>
          <div class="days">4</div>
          <div class="duration">Reviews</div>
        </div>
      </div>
      <hr />

      <div class="description">
        <h2>About This Package</h2>
      </div>

      <p class="p"><%=package.description %></p>

      <!-- <div class="description">
        <h2>Package Highlights</h2>
      </div> -->

      <!-- <div class="list">
        <ul>
          <li *ngFor="let highlight of package.highlights">
            <i class="fa-regular fa-circle-check"></i> {{ highlight }}
          </li>
        </ul>
      </div> -->

      <div class="description">
        <h2>Package Features</h2>
      </div>

      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon"><i class="fa-solid fa-fire"></i></div>
          <div class="feature-content">
            <h4>Popular Choice</h4>
            <p>Most booked package this season</p>
          </div>
        </div>

        <div class="feature-card">
          <div class="feature-icon"><i class="fa-solid fa-crown"></i></div>
          <div class="feature-content">
            <h4>Best Seller</h4>
            <p>Top rated by travelers</p>
          </div>
        </div>

        <div class="feature-card">
          <div class="feature-icon"><i class="fa-solid fa-gem"></i></div>
          <div class="feature-content">
            <h4>Premium Experience</h4>
            <p>Luxury accommodations included</p>
          </div>
        </div>

        <div class="feature-card">
          <div class="feature-icon">
            <i class="fa-solid fa-shield-check"></i>
          </div>
          <div class="feature-content">
            <h4>Safe & Secure</h4>
            <p>Travel insurance included</p>
          </div>
        </div>
      </div>

      <div class="description itinerary">
        <h2>Package Itinerary</h2>
      </div>

      <div class="card-container">
  <% for (let item of package.itinerary) { %>
    <div class="it-card" style="width: 50rem">
      <div class="card-body">
        <div class="day-number"><%= item.day %></div>

        <div class="card-content">
          <h5 class="card-title"><%= item.title %></h5>
          <p class="card-text-d"><%= item.description %></p>
        </div>
      </div>
    </div>
  <% } %>
</div>


      <div class="description itinerary">
        <h2>What's Included</h2>
      </div>

      <div class="list includes">
        <ul>
          <% for(let item of package.include) { %>
          <li>
            <i class="fa-regular fa-circle-check"></i> <%=item%>
          </li>
          <% } %>
        </ul>
      </div>

      
    </section>

    
    <!-- Right Sidebar -->
    <aside class="right-sidebar">
      <!-- Booking Card -->
      <div class="booking-card">
        <h3>Book This Trip</h3>
        <div class="price-section">
          <div class="price-value"> 
            &#8377; <%= package.price ? package.price.toLocaleString("en-IN") :
            "0" %>
          </div>
         
          <div class="price-label">Price per person:</div>
        </div>
        <button  class="book-now-btn btn-signup " >
          <a style="text-decoration: none;  color: #fff;" href="/packages/<%= package.id %>/packageBookingForm">Book Now</a>
       
        </button>

        <button
          class="wishlist-btn contact-expert-btn"
        >
          Add to Wishlist
        </button>
      </div>

      <!-- Need Help Card -->
      <div class="booking-card">
        <h4>Need Help?</h4>
        <div class="help-item">
          <div class="help-icon">
            <i class="fa-solid fa-plane"></i>
          </div>
          <div class="help-text">Flight booking assistance</div>
        </div>
        <div class="help-item">
          <div class="help-icon">
            <i class="fa-solid fa-bed"></i>
          </div>
          <div class="help-text">Accommodation upgrades</div>
        </div>
        <div class="help-item">
          <div class="help-icon">
            <i class="fa-solid fa-car"></i>
          </div>
          <div class="help-text">Local transport arrangements</div>
        </div>
        <button
          class="contact-expert-btn wishlist-btn"
        >
          Contact Travel Expert
        </button>
      </div>
    </aside>
  </div>
  <!-- <hr>  -->
    


  

  <!-- REVIEW SECTION  -->
  <div class="review-content show-heading ">
    <!-- <hr /> -->

    <% if (currUser && !package.owner.equals(currUser._id)) { %>
      <!-- <hr> -->
      <h4 class="mb-4 ">Leave a Reviews</h4>

  <form
    novalidate
    class="mb-5 needs-validation"
    action="/packages/<%= package.id %>/reviews"
    method="POST"
  >
  
      <div class="mt-3">
        <label for="rating" class="form-label"> Rating</label>
    <fieldset class="starability-grow fa-stars ">
  <input type="radio" id="no-rate" class="input-no-rate " name="review[rating]"value="1" checked aria-label="No rating." />
  <input type="radio" id="first-rate1" name="review[rating]" value="1" />
  <label for="first-rate1" title="Terrible">1 star</label>
  <input type="radio" id="first-rate2" name="review[rating]" value="2" />
  <label for="first-rate2" title="Not good">2 stars</label>
  <input type="radio" id="first-rate3" name="review[rating]" value="3" />
  <label for="first-rate3" title="Average">3 stars</label>
  <input type="radio" id="first-rate4" name="review[rating]" value="4" />
  <label for="first-rate4" title="Very good">4 stars</label>
  <input type="radio" id="first-rate5" name="review[rating]" value="5" />
  <label for="first-rate5" title="Amazing">5 stars</label>
</fieldset>
 </div>

    <div class="mb-3">
      <label for="comment" class="form-label"> Comments</label>
      <textarea
        name="review[comment]"
        id="comment"
        cols="30"
        rows="5"
        class="form-control"
        required
      ></textarea>

      <!-- //bootstrap classes for success failure text -->
      <div class="valid-feedback">Looks Good!</div>
      <div class="invalid-feedback">Please write the review!</div>
    </div>

    <button class="btn btn-login mt-3">Submit</button>
  </form>
<% } %>

<% if(package.reviews.length > 0){ %>
    <!-- <hr> -->
    
<section class="top-destination">
  <div class="heading">
    <h1>What Our Travelers Say</h1>
    <h5>
      Real experiences from real travelers who chose stayNest for their <br />
      adventures
    </h5>
  </div>



  
  <div class="testimonials-scroll-container">
  <% for (let reviews of package.reviews) { %>

    
   
  <div class="testimonial-card review-card">
      <div class="quote">❝</div>
         <p class="starability-result staticCardStar five-stars " data-rating = <%=reviews.rating %>>
  </p> 
      <p class="customer-review">
       <%=reviews.comment  %>
      </p>
      <div class="test-details">
        <div class="user-avatar">
          <img src="/images/image.png" />
        </div>

        <div class="user-info">
          <span class="user-name"><%=reviews.author.username  %></span>
          <span class="from"><%=package.country%></span>
          <span class="pack-name"><%=package.title  %></span>
        </div>
      </div>
          <!-- Review Delete button  -->

    <form
      action="/packages/<%= package._id %>/reviews/<%= reviews._id %>?_method=DELETE"
      method="POST"
      class="mb-1 mt-1"
    >
      <% if (currUser && !package.owner.equals(currUser._id)) { %>
      <button class="btn btn-sm btn-login ">Delete</button>
        <% } %>
    </form>
    </div>
  


  <% } %>
 </div>
</div>
</div>
</section>

<% } %>



  <div class="travel-agent">
    <h1>Would you like to customize this package?</h1>
    <p>
      Our travel experts will tailor it to suit your preferences and budget.
    </p>
    <div class="btn">
  <a class="btn-signup"
    >Contact Travel Expert &rarr;</a
  >
</div>
  </div>


</div>
<script> // 5. Back Button
document.getElementById("backBtn").addEventListener("click", function () {
  window.history.back();
});</script>
